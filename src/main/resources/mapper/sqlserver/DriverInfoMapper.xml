<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.car.mapper.sqlserver.DriverInfoMapper">
    <insert id="insertDriver" parameterType="com.example.car.entity.DriverInfo"  useGeneratedKeys="true" keyProperty="driverId">
       insert into driver_info (driverName,driverMobile,driverCardNo,driverReviewTime,driverStatus,driverPhotoUrl,driverSex,
       driverAddress,licenseUrl)
        values
         (#{driverName},#{driverMobile},#{driverCardNo},#{driverReviewTime},#{driverStatus},#{driverPhotoUrl},#{driverSex},
       #{driverAddress},#{licenseUrl})
   </insert>
    <select id="selectDriverInfo" resultType="com.example.car.entity.DriverInfo">
        select *  FROM  driver_info where 1=1
        <if test="driverId !=null and driverId !=''">
            and driverId=#{driverId}
        </if>
    </select>
    <update id="updateDriver">
        update driver_info set driverName=#{driverName},driverMobile=#{driverMobile},driverCardNo=#{driverCardNo},driverReviewTime=#{driverReviewTime},
        driverStatus=#{driverStatus},driverPhotoUrl=#{driverPhotoUrl},driverSex=#{driverSex},driverAddress=#{driverAddress},licenseUrl=#{licenseUrl}
        where
        driverId=#{driverId}
    </update>
    <insert id="insertDriverHistorical">
       insert into driver_historical (carId,driverId,startTime,endTime)
        values
        (#{carId},#{driverId},#{startTime},#{endTime})
    </insert>
    <select id="selectDriverHistorical" resultType="com.example.car.entity.DriverInfo">
        SELECT
        d.* ,
        h.startTime,
        h.endTime
        FROM
        driver_historical h LEFT JOIN driver_info d ON h.driverId=d.driverId
        WHERE
        1 =1
        <if test="carId !=null and carId!=''">
            h.carId=#{carId}
        </if>
    </select>
</mapper>
